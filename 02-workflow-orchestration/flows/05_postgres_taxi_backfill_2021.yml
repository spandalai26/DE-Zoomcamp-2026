id: 05_postgres_taxi_backfill_2021
namespace: zoomcamp
description: |
  Backfill local Postgres for 2021 (Janâ€“Jul) for both yellow and green taxi data.
  Uses the 05_postgres_taxi_scheduled flow with year/month inputs.

tasks:
  - id: for_each_month
    type: io.kestra.plugin.core.flow.ForEach
    values: ["01", "02", "03", "04", "05", "06", "07"]
    tasks:
      - id: run_yellow
        type: io.kestra.plugin.core.flow.Subflow
        namespace: zoomcamp
        flowId: 05_postgres_taxi_scheduled
        inputs:
          taxi: yellow
          year: "2021"
          month: "{{taskrun.value}}"

      - id: run_green
        type: io.kestra.plugin.core.flow.Subflow
        namespace: zoomcamp
        flowId: 05_postgres_taxi_scheduled
        inputs:
          taxi: green
          year: "2021"
          month: "{{taskrun.value}}"
